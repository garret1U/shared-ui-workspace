/* ==========================================================================
   Mobile Accessibility & Responsive Utilities for @garret1u/ui
   Based on WCAG guidelines and iOS/Android best practices
   ========================================================================== */

/* ==========================================================================
   Touch Target Sizing (WCAG 2.5.5 Level AAA)
   Minimum touch target size of 44x44px for mobile devices
   ========================================================================== */

.touch-target {
  @apply min-h-[44px] min-w-[44px];
}

/* Apply touch targets to interactive elements on mobile */
@media (max-width: 640px) {
  button:not([class*="touch-target-none"]),
  a[role="button"]:not([class*="touch-target-none"]),
  [role="button"]:not([class*="touch-target-none"]),
  input[type="button"]:not([class*="touch-target-none"]),
  input[type="submit"]:not([class*="touch-target-none"]),
  select:not([class*="touch-target-none"]) {
    @apply touch-target;
  }
}

/* Opt-out class for components that handle their own sizing */
.touch-target-none {
  min-height: unset;
  min-width: unset;
}

/* ==========================================================================
   iOS Zoom Prevention
   Prevents unwanted zoom on input focus in iOS Safari
   ========================================================================== */

input[type="text"],
input[type="email"],
input[type="tel"],
input[type="password"],
input[type="number"],
input[type="search"],
input[type="url"],
input[type="date"],
input[type="datetime-local"],
input[type="month"],
input[type="time"],
input[type="week"],
select,
textarea {
  /* iOS requires 16px font size to prevent zoom */
  font-size: max(16px, 1rem);
}

/* ==========================================================================
   Tap Highlight
   Subtle tap feedback for better mobile UX
   ========================================================================== */

* {
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0.05);
}

/* Remove tap highlight for specific elements */
button,
a {
  -webkit-tap-highlight-color: transparent;
}

/* ==========================================================================
   Smooth Scrolling with Reduced Motion Support
   ========================================================================== */

html {
  scroll-behavior: smooth;
}

/* Respect user's motion preferences */
@media (prefers-reduced-motion: reduce) {
  html {
    scroll-behavior: auto;
  }

  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* ==========================================================================
   Responsive Typography with Clamp
   Fluid typography that scales smoothly across viewport sizes
   ========================================================================== */

.text-display-2xl {
  font-size: clamp(2.5rem, 5vw, 4.5rem);
  line-height: 1.1;
  letter-spacing: -0.02em;
  font-weight: 800;
}

.text-display-xl {
  font-size: clamp(2rem, 4vw, 3.75rem);
  line-height: 1.1;
  letter-spacing: -0.02em;
  font-weight: 800;
}

.text-display-lg {
  font-size: clamp(1.875rem, 3.5vw, 3rem);
  line-height: 1.2;
  letter-spacing: -0.01em;
  font-weight: 700;
}

.text-heading-xl {
  font-size: clamp(1.5rem, 3vw, 2.25rem);
  line-height: 1.3;
  font-weight: 700;
}

.text-heading-lg {
  font-size: clamp(1.25rem, 2.5vw, 1.875rem);
  line-height: 1.3;
  font-weight: 600;
}

.text-heading-md {
  font-size: clamp(1.125rem, 2vw, 1.5rem);
  line-height: 1.4;
  font-weight: 600;
}

.text-body-lg {
  font-size: clamp(1rem, 1.5vw, 1.125rem);
  line-height: 1.6;
}

/* ==========================================================================
   Mobile-Optimized Components
   ========================================================================== */

/* Swipeable Container with Scroll Snap */
.swipe-container {
  display: flex;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
  -webkit-overflow-scrolling: touch;
  gap: var(--spacing-md, 1rem);
  padding-bottom: var(--spacing-md, 1rem);
}

.swipe-item {
  flex: 0 0 auto;
  scroll-snap-align: start;
  width: 280px;
}

/* Hide scrollbar but keep functionality */
.swipe-container::-webkit-scrollbar {
  display: none;
}

.swipe-container {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

/* ==========================================================================
   Mobile Table Transformation
   Convert tables to card-style layout on mobile
   ========================================================================== */

@media (max-width: 767px) {
  .mobile-table {
    display: block;
  }

  .mobile-table thead {
    display: none;
  }

  .mobile-table tbody {
    display: block;
  }

  .mobile-table tr {
    display: block;
    margin-bottom: var(--spacing-md, 1rem);
    padding: var(--spacing-md, 1rem);
    background: var(--color-background, #ffffff);
    border: 1px solid var(--color-border, #e5e7eb);
    border-radius: var(--radius-md, 0.5rem);
  }

  .mobile-table td {
    display: flex;
    justify-content: space-between;
    padding: var(--spacing-xs, 0.25rem) 0;
    border: none;
  }

  .mobile-table td::before {
    content: attr(data-label);
    font-weight: 600;
    color: var(--color-muted-foreground, #6b7280);
  }
}

/* ==========================================================================
   Safe Area Insets for iOS Notch/Home Indicator
   ========================================================================== */

.safe-area-inset-top {
  padding-top: env(safe-area-inset-top);
}

.safe-area-inset-bottom {
  padding-bottom: env(safe-area-inset-bottom);
}

.safe-area-inset-left {
  padding-left: env(safe-area-inset-left);
}

.safe-area-inset-right {
  padding-right: env(safe-area-inset-right);
}

.safe-area-inset {
  padding-top: env(safe-area-inset-top);
  padding-bottom: env(safe-area-inset-bottom);
  padding-left: env(safe-area-inset-left);
  padding-right: env(safe-area-inset-right);
}

/* ==========================================================================
   Focus Visible States
   Enhanced focus indicators for keyboard navigation
   ========================================================================== */

*:focus-visible {
  outline: 2px solid var(--color-ring, #3b82f6);
  outline-offset: 2px;
  border-radius: var(--radius-sm, 0.375rem);
}

/* Remove default focus outline */
*:focus:not(:focus-visible) {
  outline: none;
}

/* ==========================================================================
   High Contrast Mode Support
   ========================================================================== */

@media (prefers-contrast: high) {
  * {
    border-width: 2px;
  }

  button,
  a[role="button"],
  [role="button"] {
    border: 2px solid currentColor;
  }
}

/* ==========================================================================
   Dark Mode Utilities
   ========================================================================== */

/* Force dark mode on specific elements */
.force-dark {
  color-scheme: dark;
}

/* Force light mode on specific elements */
.force-light {
  color-scheme: light;
}

/* ==========================================================================
   Print Optimization
   ========================================================================== */

@media print {
  /* Hide interactive elements */
  button,
  [role="button"],
  .no-print {
    display: none !important;
  }

  /* Ensure proper page breaks */
  .page-break-before {
    page-break-before: always;
  }

  .page-break-after {
    page-break-after: always;
  }

  .page-break-avoid {
    page-break-inside: avoid;
  }

  /* Optimize colors for print */
  * {
    background: white !important;
    color: black !important;
    box-shadow: none !important;
    text-shadow: none !important;
  }

  /* Show URLs for links */
  a[href^="http"]::after {
    content: " (" attr(href) ")";
    font-size: 0.8em;
    color: #666;
  }
}

/* ==========================================================================
   Screen Reader Only Content
   ========================================================================== */

.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

/* Make sr-only content focusable when navigating via keyboard */
.sr-only-focusable:focus,
.sr-only-focusable:active {
  position: static;
  width: auto;
  height: auto;
  overflow: visible;
  clip: auto;
  white-space: normal;
}

/* ==========================================================================
   Truncation Utilities
   ========================================================================== */

.truncate-1 {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.truncate-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.truncate-3 {
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* ==========================================================================
   Loading States
   ========================================================================== */

.loading-overlay {
  position: relative;
  pointer-events: none;
  opacity: 0.6;
}

.loading-overlay::after {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 2rem;
  height: 2rem;
  border: 2px solid var(--color-primary, #3b82f6);
  border-right-color: transparent;
  border-radius: 50%;
  animation: spin 0.75s linear infinite;
}

/* ==========================================================================
   Aspect Ratio Containers
   ========================================================================== */

.aspect-square {
  aspect-ratio: 1 / 1;
}

.aspect-video {
  aspect-ratio: 16 / 9;
}

.aspect-portrait {
  aspect-ratio: 3 / 4;
}

.aspect-landscape {
  aspect-ratio: 4 / 3;
}

/* ==========================================================================
   Container Queries Support
   Requires @tailwindcss/container-queries plugin
   ========================================================================== */

.container-query {
  container-type: inline-size;
}

/* ==========================================================================
   Utility: Visually Hidden but Accessible
   ========================================================================== */

.visually-hidden {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}
